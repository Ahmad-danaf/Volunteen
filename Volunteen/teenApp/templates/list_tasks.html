{% extends 'base.html' %}
{% load static %}
{% block content %}
<style>
    .task-table {
        font-size: 0.9em;
        width: 100%;
        table-layout: auto;
        white-space: nowrap;
    }
    .task-image {
        max-width: 40px;
        height: auto;
    }
    .task-table td, .task-table th {
        vertical-align: middle;
        padding: 4px;
        text-align: center;
    }
    .task-table-container {
        overflow-x: auto;
    }
    @media (max-width: 768px) {
        .task-table {
            font-size: 0.8em;
        }
        .task-image {
            max-width: 30px;
        }
        .task-table th,
        .task-table td {
            padding: 3px;
        }
        .task-table th:nth-child(5),
        .task-table td:nth-child(5),
        .task-table th:nth-child(7),
        .task-table td:nth-child(7),
        .task-table th:nth-child(8),
        .task-table td:nth-child(8) {
            display: none;
        }
    }
</style>

<div class="container mt-5">
  <h2>Task List</h2>
  <table class="table task-table">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Image</th>
        <th scope="col">Task</th>
        <th scope="col">Description</th>
        <th scope="col">Points</th>
        <th scope="col">Deadline</th>
        <th scope="col">Duration</th>
        <th scope="col">Additional Details</th>
      </tr>
    </thead>
    <tbody>
      {% for task in tasks %}
        <tr>
          <th scope="row">{{ forloop.counter }}</th>
          <td>
            {% if task.img %}
              <img src="{{ task.img }}" alt="Task Image" class="task-image" />
            {% else %}
              <img src="{% static 'alt.jpeg' %}" alt="Default Image" class="task-image" />
            {% endif %}
          </td>
          <td>{{ task.title }}</td>
          <td>{{ task.description }}</td>
          <td>{{ task.points }}</td>
          <td> <script>
            var deadlineStr = "{{ task.deadline }}";
            // Split the date string into day, month, and year parts
            var parts = deadlineStr.split('/');
            // Create a new Date object with year, month (subtract 1 as JS months are 0-based), and day
            var deadline = new Date(parts[2], parts[1] - 1, parts[0]);
             // Format the date as DD/MM/YYYY
            var formattedDeadline = (deadline.getDate() < 10 ? '0' : '') + deadline.getDate() + '/' + ((deadline.getMonth() + 1) < 10 ? '0' : '') + (deadline.getMonth() + 1) + '/' + deadline.getFullYear();
            document.write(formattedDeadline);
        </script></td>
          <td>{{ task.duration }}</td> 
          <td>{{ task.adddetails }}</td> 
        </tr>
      {% endfor %}
      {% if tasks|length == 0 %}
        <tr>
          <td colspan="8" class="text-center">No Tasks Found</td>
        </tr>
      {% endif %}
    </tbody>
  </table>
  <a href="{% url 'home_redirect' %}" class="btn btn-secondary">Home Page</a>
</div>
{% endblock %}
